!function(e){var t={};function i(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(r,a,function(t){return e[t]}.bind(null,a));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=162)}({162:function(e,t){if(wp.media){wp.media.events.on("editor:image-edit",(function(e){e.metadata.cldoverwrite=null,e.image.className.split(" ").indexOf("cld-overwrite")>=0&&(e.metadata.cldoverwrite="true")})),wp.media.events.on("editor:image-update",(function(e){var t=e.image.className.split(" ");e.metadata.cldoverwrite&&-1===t.indexOf("cld-overwrite")?t.push("cld-overwrite"):!e.metadata.cldoverwrite&&t.indexOf("cld-overwrite")>=0&&delete t[t.indexOf("cld-overwrite")],e.image.className=t.join(" ")}));var i=null,r=wp.media.string.props;wp.media.string.props=function(e,t){return e.cldoverwrite&&(e.classes=["cld-overwrite"],i=!0),r(e,t)},wp.media.post=function(e,t){if("send-attachment-to-editor"===e){var r=wp.media.editor.get().state().get("selection").get(t.attachment);r.attributes.transformations&&(t.attachment.transformations=r.attributes.transformations),(t.html.indexOf("cld-overwrite")>-1||!0===i)&&(t.attachment.cldoverwrite=!0,i=null)}return wp.ajax.post(e,t)};var a=wp.media.view.MediaFrame.Select,n=wp.media.view.MediaFrame.Post,o=wp.media.view.MediaFrame.ImageDetails,d=wp.media.view.MediaFrame.VideoDetails,l=wp.media.view.Settings.AttachmentDisplay,s=wp.media.View.extend({tagName:"div",className:"cloudinary-widget",template:wp.template("cloudinary-dam"),active:!1,toolbar:null,frame:null,ready:function(){var e=this.controller,t=this.model.get("selection"),i=this.model.get("library"),r=wp.media.model.Attachment;if(CLDN.mloptions.multiple=e.options.multiple,this.cid!==this.active){if(CLDN.mloptions.inline_container="#cloudinary-dam-"+e.cid,1===t.length){var a=r.get(t.models[0].id);void 0!==a.attributes.public_id&&(CLDN.mloptions.asset={resource_id:a.attributes.public_id})}else CLDN.mloptions.asset=null;try{CLDN.mloptions.folder||(CLDN.mloptions.folder={path:""});var n=t.props.attributes.type;CLDN.mloptions.folder.resource_type=Array.isArray(n)?n[0]:n}catch(e){}window.ml=cloudinary.openMediaLibrary(CLDN.mloptions,{insertHandler:function(a){for(var n=0;n<a.assets.length;n++){var o=a.assets[n];wp.media.post("cloudinary-down-sync",{nonce:CLDN.nonce,asset:o}).done((function(a){var n=function(e,t){e.uploading=!1,t.set(e),wp.Uploader.queue.remove(t),0===wp.Uploader.queue.length&&wp.Uploader.queue.reset()};if(void 0!==a.resync&&a.resync.forEach((function(e){r.get(e.id).set(e)})),void 0!==a.fetch){var o=r.get(a.attachment_id);o.set(a),i.add(o),wp.Uploader.queue.add(o),wp.ajax.send({url:a.fetch,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",CLDN.nonce)},data:{src:a.url,filename:a.filename,attachment_id:a.attachment_id,transformations:a.transformations}}).done((function(e){var t=r.get(e.id);n(e,t)})).fail((function(e){n(a,o),i.remove(o),t.remove(o),"string"==typeof e?alert(e):500===e.status&&alert("HTTP error.")}))}else{var d=r.get(a.id);d.set(a),t.add(d)}0===wp.Uploader.queue.length&&wp.Uploader.queue.reset(),e.content.mode("browse")}))}}},document.querySelectorAll(".dam-cloudinary")[0])}return this.active=this.cid,this}}),c=function(e){return{bindHandlers:function(){e.prototype.bindHandlers.apply(this,arguments),this.on("content:render:cloudinary",this.cloudinaryContent,this)},browseRouter:function(t){e.prototype.browseRouter.apply(this,arguments),t.set({cloudinary:{text:"Cloudinary",priority:60}})},cloudinaryContent:function(){this.$el.addClass("hide-toolbar");var e=this.state(),t=new s({controller:this,model:e}).render();this.content.set(t)}}};wp.media.view.MediaFrame.Select=a.extend(c(a)),wp.media.view.MediaFrame.Post=n.extend(c(n)),wp.media.view.MediaFrame.ImageDetails=o.extend(c(o)),wp.media.view.MediaFrame.VideoDetails=d.extend(c(d)),wp.media.view.Settings.AttachmentDisplay=l.extend((u=l,{initialize:function(){u.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:cldoverwrite",this.handleOverwrite)},handleOverwrite:function(e){var t=this.options.attachment.attributes.sizes;for(var i in t){var r=new URL(t[i].url);e.attributes.cldoverwrite?r.searchParams.set("cld_overwrite",!0):r.searchParams.delete("cld_overwrite"),this.options.attachment.attributes.sizes[i].url=r.href}}}))}var u}});