---
import { mq } from '../../_foundation/mq';
import { cloudinaryAPIConverter } from '../../_foundation/converter';
import WorksDetail from '../../_components/page.works-single/index.view';
import { createWorksRepository } from '../../_repositories/cms';
import Layout from '../../layout.astro';

const { slug } = Astro.params;

const repo = createWorksRepository()
const result = await repo.findItem({
  slug: slug!,
})

export const prerender = false;
---

<Layout title={result.title} permalink={`/work/${result.slug}/`} namespace="works-single">
  <link
    slot="prependHead"
    as="image"
    crossorigin="anonymous"
    href={cloudinaryAPIConverter(result.mv["pc"].url, "f_auto,q_auto,w_1680")}
    media={mq.pc}
    rel="preload"
  />
  <WorksDetail post={result} nextPost={result} projectNumber={1} namespace="works-single" />
</Layout>
